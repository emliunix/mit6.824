Origin go code preserved for reference. Though slight changes for current go compiler.
